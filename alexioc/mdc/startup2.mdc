#! ./genericStream

epicsEnvSet(IOCSH_PS1, "mdc>")
epicsEnvSet(EPICS_TS_NTP_INET,"142.90.98.144")
epicsEnvSet(EPICS_TIMEZONE,"UTC::480:40404:103104")
epicsEnvSet(EPICS_IOC_CA_PUT_LOG_INET,"142.90.98.144")
epicsEnvSet(EPICS_IOC_CA_PUT_LOG_PORT,"7000")
epicsEnvSet(EPICS_IOC_LOG_PORT,"7015")
epicsEnvSet(EPICS_CA_REPEATER_PORT, 9191)
epicsEnvSet(EPICS_CA_SERVER_PORT, 9192)
epicsEnvSet(EPICS_TS_MIN_WEST, 480)

epicsEnvSet(STREAM_PROTOCOL_PATH,".")

# ====== load and intialize application DBD file(s) =================
# (this must match the name of the executable binary in the shebang line)
dbLoadDatabase("genericStream.dbd")
genericStream_registerRecordDeviceDriver(pdbbase)

#
# =========== Configure Asyn Ports =======================
#                       Bus    IP Address:Port
drvAsynIPPortConfigure("RS485","192.168.1.4:100",0,1,0)

#
# =========== Load EPICS runtime DB =======================
#
dbLoadRecords("mdc.db")
#
#  Don't use ADDR=10, here (in use by application DB), but okay to change after iocInit
#
dbLoadRecords("asynRecord.db","P=ALEX:,R=ASYN,PORT=RS485,ADDR=2,IMAX=0,OMAX=0")

## ===================================================
iocInit
## ===================================================

# caPutLogInit("142.90.148.155:7000",1)
caPutLogInit("icsl6.ggeng.triumf.ca:7000",1)
asInit()

# var scopeReadDebug 0
# var wfcursorDebug 0
var streamDebug 0