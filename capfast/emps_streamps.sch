[schematic2]
uniq 10
[tools]
[detail]
w 1716 955 100 0 n#1 trcalcos.$(PS):STATUS.INPL 1824 952 1608 952 1608 1752 1072 1752 inhier.enable.P
w 1096 1131 100 0 n#2 trcalcos.$(PS):STATCOMM.SLNK 1208 1128 984 1128 inhier.scanin.P
w 1572 1323 100 0 n#3 trcalcos.$(PS):STATCOMM.VAL 1496 1320 1648 1320 1648 1240 1824 1240 trcalcos.$(PS):STATUS.INPC
w 1524 1355 100 0 n#4 trcalcos.$(PS):STATCOMM.FLNK 1496 1352 1552 1352 1552 920 1824 920 trcalcos.$(PS):STATUS.SLNK
w 1940 1867 100 0 n#1 ecalcos.$(PS):DRVDISABLE.INPA 2080 1864 1800 1864 1800 1736 1608 1736 junction
w 2115 1240 100 0 n#5 trcalcos.$(PS):STATUS.FLNK 2112 1144 2112 1336 1960 1336 1960 1480 2080 1480 ecalcos.$(PS):DRVDISABLE.SLNK
w 4680 1851 100 0 n#6 ecalcos.$(PS):CURTRIP.FLNK 4632 1848 4728 1848 outhier.flink.p
w 2680 1707 100 0 n#7 ecalcos.$(PS):DRVDISABLE.FLNK 2368 1704 2992 1704 2992 1536 3616 1536 ecalcos.$(PS):CURDISABLE.SLNK
w 4656 1819 100 0 n#8 ecalcos.$(PS):CURTRIP.VAL 4632 1816 4680 1816 4680 1784 4728 1784 outhier.statok.p
w 4044 1763 100 0 n#9 ecalcos.$(PS):CURDISABLE.FLNK 3904 1760 4184 1760 4184 1624 4344 1624 ecalcos.$(PS):CURTRIP.SLNK
n 2619 1971 3121 2043 100
FUNCTIONALITY:
CHECK THAT STREAM DEVICE OPTICS ELEMENT IS ON,
COMMUNICATING AND NOT IN TIMEOUT STATE.
_
n 2145 1138 2466 1234 100
LED RULES FOR $(D)$(PS):STATUS:
0: PATH BAD -> RED
1: PATH GOOD -> GREEN
2: DISABLED -> BLACK
_
n 2812 1987 3215 2057 150
Functionality:
Please add functionality here
_
[cell use]
use bb200tr 712 632 100 0 bb200tr#2
xform 0 1992 1432
p 2296 824 150 0 -1 seta:M. Rowe
p 2152 1016 150 0 -1 sets:E-Linac Control System
p 2152 984 100 0 -1 sett0:Machine Protect System
p 2152 952 100 0 -1 sett1:Optics Subsystem - Stream Device PS Status
p 2568 824 150 0 -1 setdat:2016/08/15
p 2328 872 200 0 -1 setd:$Revision: 1.5 $
p 2168 760 150 0 -1 setf:emps_streamps.sch
use trcalcos 1908 811 100 0 $(PS):STATUS
xform 0 1968 1112
p 1852 811 100 0 -1 PV:$(D)
p 1657 1298 100 0 -1 def(INPA):$(PS):STATON
p 1646 1265 100 0 -1 def(INPB):$(PS):STATTMO
p 1602 1233 100 0 0 def(INPC):
p 1578 1201 100 0 -1 def(INPD):$(D)$(PS):CURDISABLE
p 1904 1272 150 0 1 CALC:L?((A&!B)?1:0):2
p 1903 1251 100 0 1 OCAL:L?(!C?3:(B?2:(!A?1:(D?5:0)))):4
p 2118 1075 100 0 1 def(OUT):$(D)$(PS):STATTEXT PP
p 1904 1016 100 0 1 OOPT:Every Time
p 1902 994 100 0 1 DOPT:Use OCAL
p 1556 1163 100 0 0 def(INPE):
p 1519 1136 100 0 0 def(INPF):
p 1613 1105 100 0 0 def(INPG):
p 1614 1074 100 0 0 def(INPH):
p 1589 1040 100 0 0 def(INPI):
p 1648 1009 100 0 0 def(INPJ):
use embbis 4002 1384 100 0 $(PS):STATTEXT
xform 0 4096 1448
p 4038 1350 100 0 1 ONVL:1
p 4041 1333 100 0 1 TWVL:2
p 4043 1316 100 0 1 THVL:3
p 4128 1368 100 0 1 ZRST:OK
p 4123 1350 100 0 1 ONST:Off
p 4127 1331 100 0 1 TWST:Timeout
p 4129 1315 100 0 1 THST:Comm.
p 4043 1370 100 0 1 ZRVL:0
p 3946 1384 100 0 -1 PV:$(D)
p 4045 1299 100 0 1 FRVL:4
p 4133 1297 100 0 1 FRST:Not Monitored
p 4048 1286 100 0 1 FVVL:5
p 4046 1271 100 0 0 SXVL:0
p 4132 1280 100 0 1 FVST:Tune Lock
p 4133 1268 100 0 0 SXST:
use inhier 947 1152 100 0 scanin
xform 0 984 1128
use outhier 4699 1878 100 0 flink
xform 0 4712 1848
use inhier 1037 1774 100 0 enable
xform 0 1072 1752
use outhier 4695 1801 100 0 statok
xform 0 4712 1784
use trcalcos 1273 1035 100 0 $(PS):STATCOMM
xform 0 1352 1320
p 1217 1035 100 0 -1 PV:$(D)
p 983 1505 100 0 -1 def(INPA):$(PS):STATON.STAT
p 992 1474 100 0 -1 def(INPB):$(PS):RDDAC.STAT
p 994 1441 100 0 -1 def(INPC):$(PS):RDVOL.STAT
p 894 1409 100 0 -1 def(INPD):$(PS):RDUNSIGNEDCUR.STAT
p 992 1378 100 0 -1 def(INPE):$(PS):RDOCP.STAT
p 993 1346 100 0 -1 def(INPF):$(PS):RDOVP.STAT
p 1019 1311 100 0 -1 def(INPG):$(PS):IDN.STAT
p 1023 1281 100 0 0 def(INPH):
p 1288 1480 150 0 1 CALC:!(A&&B&&C&&D&&E&&F&&G)
p 1292 1460 100 0 1 OCAL:0
use ecalcos 2127 1380 100 0 $(PS):DRVDISABLE
xform 0 2224 1672
p 2071 1380 100 0 -1 PV:$(D)
p 2160 1832 150 0 1 CALC:A&(B=1)
p 2384 1636 100 0 1 def(OUT):$(PS):DRVNOCHANGE.DISA
p 2164 1812 100 0 1 OCAL:0
p 1900 1825 100 0 -1 def(INPB):$(D)$(PS):STATUS
p 2160 1576 100 0 1 OOPT:On Change
use ecalcos 4391 1524 100 0 $(PS):CURTRIP
xform 0 4488 1816
p 4335 1524 100 0 -1 PV:$(D)
p 4424 1976 150 0 1 CALC:A?(ABS(B-C)<(0.005*ABS(D-E))):F
p 4652 1777 100 0 0 def(OUT):
p 4428 1956 100 0 1 OCAL:0
p 4149 1972 100 0 1 def(INPB):$(PS):CUR
p 4424 1720 100 0 1 OOPT:On Change
p 4123 1937 100 0 1 def(INPC):$(PS):RDCUR
p 4091 1903 100 0 1 def(INPD):$(PS):CUR.DRVH
p 4098 1874 100 0 1 def(INPE):$(PS):CUR.DRVL
p 4083 1840 100 0 1 def(INPF):$(D)$(PS):STATUS
p 4041 2002 100 0 1 def(INPA):$(D)$(PS):CURDISABLE
p 4232 1912 100 0 0 def(FLNK):
p 4396 1660 100 0 0 SCAN:Passive
use ecalcos 3663 1436 100 0 $(PS):CURDISABLE
xform 0 3760 1728
p 3607 1436 100 0 -1 PV:$(D)
p 3701 1886 150 0 1 CALC:(A>2)&B
p 3924 1689 100 0 1 def(OUT):$(PS):CUR.DISP PP MS
p 3700 1868 100 0 1 OCAL:0
p 3347 1883 100 0 1 def(INPB):$(D)$(PS):STATUS
p 3696 1632 100 0 1 OOPT:On Change
p 3327 1853 100 0 0 def(INPC):
p 3323 1822 100 0 0 def(INPD):
p 3359 1784 100 0 0 def(INPE):
p 3370 1751 100 0 0 def(INPF):
p 3700 1604 100 0 1 DOPT:Use CALC
p 3339 1919 100 0 1 def(INPA):EMPS:BMPROPREQ
[comments]
